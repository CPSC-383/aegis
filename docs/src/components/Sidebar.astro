---
import type { CollectionEntry } from "astro:content";

interface Props {
  groupedDocs: Record<string, CollectionEntry<"docs" | "getting-started">[]>;
  collection: string;
}

const { groupedDocs, collection } = Astro.props;

const capitalizeSection = (section: string) => {
  return section
    .split("-")
    .map((word) => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase())
    .join(" ");
};

const currentUrl = Astro.url.pathname;

// Put the getting started sidebar section at the top.
const sortedSections = Object.keys(groupedDocs).sort((a, b) => {
  if (a === "getting-started") return -1;
  if (b === "getting-started") return 1;
  return a.localeCompare(b);
});
---

<div class="w-64 p-4 overflow-y-auto">
  {
    sortedSections.map((section) => (
      <div class="mt-8">
        <div class="flex justify-between items-center">
          <span class="font-semibold text-zinc-200 pl-4 mb-3 text-lg">
            {capitalizeSection(section)}
          </span>
        </div>

        {groupedDocs[section] && (
          <div>
            {groupedDocs[section].map((doc) => (
              <a
                href={`/${collection}/${doc.id}`}
                class={`block py-2 pl-4
                ${
                  currentUrl === `/${collection}/${doc.id}`
                    ? "font-semibold border-l-2 border-red-500 text-zinc-300"
                    : "text-zinc-400 hover:bg-zinc-200/5 dark:hover:text-zinc-300"
                }
              `}
              >
                {doc.data.title}
              </a>
            ))}
          </div>
        )}
      </div>
    ))
  }
</div>
